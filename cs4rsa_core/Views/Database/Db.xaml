<UserControl
  x:Class="Cs4rsa.Views.Database.Db"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="clr-namespace:Cs4rsa.Views.Database"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
  xmlns:vm="clr-namespace:Cs4rsa.ViewModels.Database"
  xmlns:vml="clr-namespace:Cs4rsa.ViewModelLocator"
  Padding="5"
  d:DataContext="{d:DesignInstance Type=vm:DbViewModel}"
  vml:ViewModelLocator.AutoHookedUpViewModel="True"
  mc:Ignorable="d">
  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="0.3*" />
      <ColumnDefinition Width="Auto" />
      <ColumnDefinition />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition />
      <RowDefinition />
    </Grid.RowDefinitions>
    <ScrollViewer
      Grid.Row="0"
      Grid.RowSpan="2"
      Grid.Column="0"
      VerticalScrollBarVisibility="Auto">
      <StackPanel>
        <Border
          Margin="0,0,5,5"
          Padding="5"
          BorderBrush="LightGray"
          BorderThickness="1"
          CornerRadius="4">
          <StackPanel>
            <TextBlock HorizontalAlignment="Center" Text="{Binding CurrentYearInf}" />
            <TextBlock
              HorizontalAlignment="Center"
              Style="{StaticResource MaterialDesignHeadline5TextBlock}"
              Text="{Binding CurrentSemesterInf}" />
          </StackPanel>
        </Border>

        <Border
          Margin="0,0,5,5"
          Padding="5"
          BorderBrush="LightGray"
          BorderThickness="1"
          CornerRadius="4">
          <StackPanel>
            <TextBlock HorizontalAlignment="Center" Text="Số lượng môn học" />
            <TextBlock
              HorizontalAlignment="Center"
              Style="{StaticResource MaterialDesignHeadline5TextBlock}"
              Text="{Binding SubjectQuantity}" />
          </StackPanel>
        </Border>

        <Border
          Margin="0,0,5,5"
          Padding="5"
          BorderBrush="LightGray"
          BorderThickness="1"
          CornerRadius="4">
          <StackPanel>
            <TextBlock
              Grid.Column="1"
              Margin="0,0,0,10"
              Style="{StaticResource MaterialDesignHeadline6TextBlock}"
              Text="Cảnh báo cập nhật" />
            <TextBlock TextAlignment="Justify" TextWrapping="Wrap">
              <TextBlock.Text>
                Việc cập nhật cơ sở dữ liệu môn học sẽ tốn một ít thời gian.
                Hãy đảm bảo tình trạng mạng ổn định và không ngắt giữa chừng trong lúc đang cập nhật.
              </TextBlock.Text>
            </TextBlock>
            <ProgressBar
              Margin="0,5,0,0"
              Maximum="1000"
              Value="{Binding ProgressValue}" />
            <Button
              Margin="0,5,0,0"
              HorizontalAlignment="Right"
              Command="{Binding StartUpdateCommand}"
              Content="BẮT ĐẦU"
              Style="{StaticResource MaterialDesignFlatButton}" />
          </StackPanel>
        </Border>
      </StackPanel>
    </ScrollViewer>

    <!--  Disciplines  -->
    <DataGrid
      Grid.Row="0"
      Grid.Column="1"
      AutoGenerateColumns="False"
      CanUserAddRows="False"
      CanUserDeleteRows="False"
      CanUserReorderColumns="False"
      ItemsSource="{Binding Disciplines}"
      SelectedItem="{Binding SltDiscipline}">
      <DataGrid.Columns>
        <DataGridTextColumn
          Binding="{Binding DisciplineId}"
          Header="ID"
          IsReadOnly="True" />
        <DataGridTextColumn
          Binding="{Binding Name}"
          Header="Mã"
          IsReadOnly="True" />
      </DataGrid.Columns>
    </DataGrid>

    <!--  Keywords  -->
    <DataGrid
      Grid.Row="0"
      Grid.Column="2"
      AutoGenerateColumns="False"
      CanUserAddRows="False"
      CanUserDeleteRows="False"
      CanUserReorderColumns="False"
      ItemsSource="{Binding Keywords}">
      <DataGrid.Columns>
        <DataGridTextColumn Header="Mã môn" IsReadOnly="True">
          <DataGridTextColumn.Binding>
            <MultiBinding StringFormat="{}{0} {1}">
              <Binding Path="Discipline.Name" />
              <Binding Path="Keyword1" />
            </MultiBinding>
          </DataGridTextColumn.Binding>
        </DataGridTextColumn>
        <DataGridTextColumn
          Binding="{Binding SubjectName}"
          Header="Tên môn"
          IsReadOnly="True" />
        <DataGridTemplateColumn Header="Màu sắc" IsReadOnly="True">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
              <Border Background="{Binding Color}" CornerRadius="4" />
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
        <DataGridTemplateColumn Header="Cache" IsReadOnly="True">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
              <Button
                Click="BtnViewCache_Clicked"
                Content="XEM"
                Style="{StaticResource MaterialDesignFlatButton}"
                Visibility="{Binding Cache, Converter={StaticResource StringIsEmptyVisibilityConverter}}" />
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
      </DataGrid.Columns>
    </DataGrid>
  </Grid>
</UserControl>
